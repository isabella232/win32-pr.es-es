---
title: Interfaces obligatorias y opcionales
description: Interfaces obligatorias y opcionales
ms.assetid: 582c9dd5-f8ab-48df-afb3-fba931ee0dea
keywords:
- Windows Media Administrador de dispositivos,interfaces
- Administrador de dispositivos,interfaces
- guía de programación, interfaces
- proveedores de servicios, interfaces
- crear proveedores de servicios, interfaces
- interfaces
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6aaa28db79fe8bc3cd159219cffb35f5434645ea
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/13/2021
ms.locfileid: "126890273"
---
# <a name="mandatory-and-optional-interfaces"></a>Interfaces obligatorias y opcionales

En la tabla siguiente se describen las interfaces y los métodos obligatorios y opcionales para que los proveedores de servicios implementen. Se deben implementar todas las interfaces con uno o varios métodos obligatorios. Un método obligatorio no puede devolver WMDM \_ E \_ NOTSUPPORTED o E \_ NOTIMPL.



| Interfaz y método                                                                                                                  | Opción de implementación                                                                                                                                                                                                                              |
|---------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IMDServiceProvider::EnumDevices**](/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider-enumdevices)                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDServiceProvider::GetDeviceCount**](/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider-getdevicecount)                                                       | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDServiceProvider2::CreateDevice**](/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider2-createdevice)                                                         | Opcional. Este método debe implementarse para la compatibilidad con PnP Windows Explorer.                                                                                                                                                                    |
| [**IMDSPDevice::EnumStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-enumstorage)                                                                           | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetDeviceIcon**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getdeviceicon)                                                                       | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetFormatSupport**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getformatsupport)                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetManufacturer**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getmanufacturer)                                                                   | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetName**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getname)                                                                                   | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetPowerSource**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getpowersource)                                                                     | Opcional.                                                                                                                                                                                                                                          |
| [**IMDSPDevice::GetSerialNumber**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getserialnumber)                                                                   | Opcional. Para la transferencia de contenido protegido, Windows Media Administrador de dispositivos **usa IMDSPStorageGlobals::GetSerialNumber**.                                                                                                                              |
| [**IMDSPDevice::GetStatus**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getstatus)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetType**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-gettype)                                                                                   | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetVersion**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getversion)                                                                             | Opcional.                                                                                                                                                                                                                                          |
| [**IMDSPDevice::SendOpaqueCommand**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-sendopaquecommand)                                                               | Opcional.                                                                                                                                                                                                                                          |
| [**IMDSPDevice2::GetTivonicalName**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getcanonicalname)                                                               | Opcional.                                                                                                                                                                                                                                          |
| [**IMDSPDevice2::GetFormatSupport2**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getformatsupport2)                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice2::GetSpecifyPropertyPages**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getspecifypropertypages)                                                 | Opcional.                                                                                                                                                                                                                                          |
| [**IMDSPDevice2::GetStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getstorage)                                                                           | Opcional.                                                                                                                                                                                                                                          |
| [**Interfaz IMDSPDeviceControl**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspdevicecontrol)                                                                            | Opcional.                                                                                                                                                                                                                                          |
| [**IMDSPEnumDevice::Clone**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-clone)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumDevice::Next**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-next)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumDevice::Reset**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-reset)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumDevice::Skip**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-skip)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage::Clone**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-clone)                                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage::Next**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-next)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage::Reset**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-reset)                                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage::Skip**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-skip)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObject::Close**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-close)                                                                                       | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObject::D elete**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-delete)                                                                                     | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObject::Move**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-move)                                                                                         | Opcional.                                                                                                                                                                                                                                          |
| [**IMDSPObject::Open**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-open)                                                                                         | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObject::Read**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-read)                                                                                         | Obligatorio (si Reproductor de Windows Media se desea la compatibilidad).                                                                                                                                                                                            |
| [**IMDSPObject::Rename**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-rename)                                                                                     | Opcional.                                                                                                                                                                                                                                          |
| [**IMDSPObject::Seek**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-seek)                                                                                         | Opcional.                                                                                                                                                                                                                                          |
| [**IMDSPObject::Write**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-write)                                                                                       | Mandatory.                                                                                                                                                                                                                                         |
| [**Interfaz IMDSPObjectInfo**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspobjectinfo)                                                                                  | Opcional.                                                                                                                                                                                                                                          |
| [**IMDSPRevoked (interfaz)**](/windows/desktop/api/mswmdm/nn-mswmdm-imdsprevoked)                                                                                        | Opcional.                                                                                                                                                                                                                                          |
| [**IMDSPStorage::CreateStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-createstorage)                                                                     | Obligatorio solo si *dwAttributes* es WMDM \_ FILE \_ ATTR \_ FILE.                                                                                                                                                                                        |
| [**IMDSPStorage::EnumStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-enumstorage)                                                                         | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetAttributes**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getattributes)                                                                     | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetDate**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getdate)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetName**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getname)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetRights**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getrights)                                                                             | Opcional.                                                                                                                                                                                                                                          |
| [**IMDSPStorage::GetSize**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getsize)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetStorageGlobals**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getstorageglobals)                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::SendOpaqueCommands**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-sendopaquecommand)                                                           | Opcional.                                                                                                                                                                                                                                          |
| [**IMDSPStorage::SetAttributes**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-setattributes)                                                                     | Opcional.                                                                                                                                                                                                                                          |
| [**IMDSPStorage2::CreateStorage2**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-createstorage2)                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage2::GetAttributes2**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-getattributes2)                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage2::GetStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-getstorage)                                                                         | Opcional.                                                                                                                                                                                                                                          |
| [**IMDSPStorage2::SetAttributes2**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-setattributes2)                                                                 | Opcional.                                                                                                                                                                                                                                          |
| [**Interfaz IMDSPStorage3**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspstorage3)                                                                                      | Opcional. Sin embargo, si el parámetro de dispositivo *UseMetadataViews* se establece en 1, se debe implementar esta interfaz y **IMDSPStorage3::GetMetadata** se convierte en obligatorio, aunque **IMDSPStorage3::SetMetadata** sigue siendo opcional.                    |
| [**IMDSPStorageGlobals::GetCapabilities**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getcapabilities)                                                   | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetDevice**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getdevice)                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetRootStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getrootstorage)                                                     | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetSerialNumber**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getserialnumber)                                                   | Obligatorio solo para PDDRM. Opcional en caso contrario.                                                                                                                                                                                                      |
| [**IMDSPStorageGlobals::GetStatus**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getstatus)                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetTotalBad**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalbad)                                                           | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetTotalFree**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalfree)                                                         | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetTotalSize**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalsize)                                                         | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::Initialize**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-initialize)                                                             | Opcional. Este método debe implementarse si el dispositivo admite esta funcionalidad. Si no se implementa este método, **IMDSPStorageGlobals::GetCapabilites** debe devolver WMDM \_ STORAGECAP NOT INITIALIZABLE además de cualquier \_ \_ otra marca. |
| [**IMDSPDevice3**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspdevice3)[**IMDSPObject2**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspobject2)<br/> [**IMDSPStorage4**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspstorage4)<br/> | Necesario para admitir la sincronización automática con Reproductor de Windows Media                                                                                                                                                                            |



 

## <a name="related-topics"></a>Temas relacionados

<dl> <dt>

[**Creación de un proveedor de servicios**](creating-a-service-provider.md)
</dt> </dl>

 

 





