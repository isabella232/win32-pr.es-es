---
description: 'Las siguientes consideraciones de seguridad se aplican a las aplicaciones que usan WinHTTP: Los certificados de servidor solo se comprueban una vez por sesión.'
ms.assetid: 287e85ed-a324-4785-872a-26e4ab37986d
title: Consideraciones de seguridad de WinHTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dc06725ba03631eb4d5e5c29f8cfa0aae69b5022
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/13/2021
ms.locfileid: "127073139"
---
# <a name="winhttp-security-considerations"></a>Consideraciones de seguridad de WinHTTP

Las siguientes consideraciones de seguridad se aplican a las aplicaciones que usan WinHTTP:

-   **Los certificados de servidor solo se comprueban una vez por sesión.** Una vez comprobado un certificado, sigue siendo válido mientras dure la sesión actual. Siempre que la huella digital del certificado coincida, lo que indica que el certificado no ha cambiado, el certificado se sigue validando de nuevo. Como resultado, cualquier cambio en los criterios de validación, a través de las marcas protocolo, revocation-check o certificate-error-ignore, no tiene efecto una vez comprobado el certificado. Para forzar que este cambio suba efecto inmediatamente, se debe finalizar la sesión actual y se debe iniciar una nueva. Del mismo modo, la expiración de un certificado durante el transcurso de una sesión solo se puede detectar si la propia aplicación comprueba periódicamente el servidor de certificados para recuperar los datos de expiración.
-   **El proxy automático implica descargar y ejecutar scripts.** La compatibilidad con la detección automática de proxy implica detectar mediante DHCP o DNS, descargar y ejecutar scripts de proxy como scripts de Java. Para lograr un mayor grado de seguridad, una aplicación debe evitar pasar la marca **RUN \_ \_ \_ INPROCESS de WINHTTP AUTOPROXY** para que la detección de proxy automático se inicie fuera de proceso. Aun así, WinHTTP intenta de forma predeterminada ejecutar un script de proxy automático en proceso si el script no se puede ejecutar correctamente fuera de proceso. Si cree que este comportamiento de reserva supone un riesgo inaceptable, deshabilite el comportamiento de reserva con la marca **RUN \_ \_ \_ OUTPROCESS \_ ONLY de WINHTTP AUTOPROXY.**
-   **Las funciones WINHTTP \_ STATUS \_ CALLBACK deben devolver rápidamente.** Al escribir una de estas funciones de devolución de llamada, tenga cuidado de que no se bloquee. Por ejemplo, ni la devolución de llamada ni ninguna función a la que llama deben mostrar un cuadro de diálogo de usuario o esperar un evento. Si una [*función WINHTTP \_ STATUS \_ CALLBACK*](/windows/win32/api/winhttp/nc-winhttp-winhttp_status_callback) se bloquea, afecta a la programación interna de WinHTTP y hace que se deniegue el servicio a otras solicitudes dentro del mismo proceso.
-   **Las funciones CALLBACK de WINHTTP \_ STATUS \_ deben ser reentrantes.** Al escribir una devolución de llamada, evite variables estáticas u otras construcciones que no sean seguras bajo reentrante y evite llamar a otras funciones que no sean reentrantes.
-   **Si es posible realizar una operación asincrónica, pase las DIRECCIONES URL para los parámetros OUT.** Si ha habilitado la operación asincrónica mediante el registro de una función de devolución de llamada, pase siempre valores **NULL** para dichos parámetros OUT como *lpdwDataAvailable* para [**WinHttpQueryDataAvailable,**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpquerydataavailable) *lpdwBytesRead* para [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata)o *lpdwBytesWritten* para [**WinHttpWriteData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpwritedata). En algunas circunstancias, el subproceso de llamada finaliza antes de que se complete la operación y, si los parámetros OUT no son **NULL,** la función puede terminar escribiendo en la memoria que ya se ha liberado.
-   **La autenticación de Passport no es infalible.** Cualquier esquema de autenticación basado en cookies es vulnerable a ataques. Passport versión 1.4 se basa en cookies y, por tanto, está sujeta a las vulnerabilidades asociadas a cualquier cookie o esquema de autenticación basado en formularios. La compatibilidad con Passport está deshabilitada de forma predeterminada en WinHTTP; se puede habilitar mediante [**WinHttpSetOption.**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption)
-   **La autenticación básica solo debe usarse a través de una conexión segura.** La autenticación básica, que envía el nombre de usuario y la contraseña en texto no cifrado (consulte [RFC 2617),](https://www.ietf.org/rfc/rfc2617.txt)solo se debe usar en conexiones SSL o TLS cifradas.
-   **Establecer la directiva de inicio de sesión automático en "bajo" puede suponer un riesgo.** Cuando la directiva de inicio de sesión automático está establecida en baja, se puede usar la credencial de inicio de sesión de un usuario para autenticarse en cualquier sitio. Sin embargo, no es una buena práctica de seguridad autenticarse en sitios en los que no confíe.
-   **Las conexiones SSL 2.0 no se usan a menos que se habiliten explícitamente.** Los protocolos de seguridad TLS 1.0 y SSL 3.0 se consideran más seguros que SSL 2.0. De forma predeterminada, WinHTTP solicita TLS 1.0 o SSL 3.0 al negociar una conexión SSL, no SSL 2.0. La compatibilidad con SSL 2.0 en WinHTTP solo se puede habilitar mediante una llamada [**a WinHttpSetOption.**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption)
-   **La comprobación de revocación de certificados debe solicitarse explícitamente.** De forma predeterminada, al realizar la autenticación de certificados, WinHTTP no comprueba si se ha revocado el certificado del servidor. La comprobación de revocación de certificados se puede habilitar [**mediante WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption).
-   **Las aplicaciones deben asegurarse de que una sesión se asigna a una única identidad.** Una sesión WinHTTP debe asignarse a una sola identidad; Es decir, se usa una sesión WinHTTP para administrar la actividad de Internet de un solo usuario autenticado o de un grupo de usuarios anónimos. Sin embargo, dado que WinHTTP no aplica esta asignación automáticamente, la aplicación debe tomar medidas para asegurarse de que solo interviene una única identidad.
-   **Las operaciones en un identificador de solicitud WinHTTP deben sincronizarse.** Por ejemplo, una aplicación debe evitar cerrar un identificador de solicitud en un subproceso mientras otro subproceso envía o recibe una solicitud. Para finalizar una solicitud asincrónica, cierre el identificador de solicitud durante una notificación de devolución de llamada. Para finalizar una solicitud sincrónica, cierre el identificador cuando se devuelva la llamada WinHTTP anterior.
-   **Los archivos de seguimiento contienen información confidencial.** Los archivos de seguimiento se protegen mediante listas de Access-Control (ACL), de modo que normalmente solo el administrador local o la cuenta de usuario que lo creó pueda acceder a ellos. Evite poner en peligro los archivos de seguimiento por cualquier acceso no autorizado.
-   **Evite pasar datos confidenciales a través** [**de WinHttpSetOption.**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) No proporcione un nombre de usuario, una contraseña o ninguna otra credencial a **WinHttpSetOption** porque no tiene control sobre el esquema de autenticación que se usa y los datos confidenciales podrían enviarse inesperadamente en texto no definido. Use [**WinHttpQueryAuthSchemes**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryauthschemes) y **WinHttpSetCredentials** en lugar de **WinHttpSetOption** para establecer las credenciales.
-   **El redireccionamiento automático puede suponer un riesgo para la seguridad.** De forma predeterminada, el redireccionamiento (un mensaje 302) se sigue automáticamente incluso para post. Para evitar la posibilidad de redirecciones falsos, las aplicaciones deben deshabilitar la redirección automática o supervisar la redireccionamiento en las devoluciones de llamada al publicar información confidencial.
-   **Los encabezados definidos por el usuario se transfieren entre redirecciones sin cambios.** Los encabezados definidos por el usuario, como las cookies agregadas con **WinHTTPAddRequestHeaders,** se transfieren a través de redirecciones sin modificaciones, mientras que los encabezados generados por WinHTTP se actualizan automáticamente. Si la transferencia de un encabezado definido por el usuario a través de redireccionamientos supone un riesgo de seguridad, use la devolución de llamada [*\_ \_ CALLBACK*](/windows/win32/api/winhttp/nc-winhttp-winhttp_status_callback) DE ESTADO WINHTTP con la finalización de REDIRECCIÓN DE ESTADO DE DEVOLUCIÓN DE LLAMADA **WINHTTP \_ \_ \_** para modificar el encabezado en cuestión cada vez que se produzca una redirección.
-   **WinHTTP no es reentrante en modo sincrónico.** Dado que WinHTTP no es reentrante en modo sincrónico, no programe llamadas a procedimientos asincrónicos (APC) que puedan llamar a WinHTTP en un subproceso de aplicación que se ejecute dentro de una función WinHTTP. Mientras está en modo sincrónico, WinHTTP realiza una "espera que se puede alertar", y si el subproceso en espera se vacía previamente para ejecutar un APC y, posteriormente, vuelve a escribir WinHTTP de nuevo, el estado interno de WinHTTP se puede dañar.

 

 
