---
title: Cómo se usan los identificadores secundarios en los parámetros
description: En este tema se describen los parámetros de entrada, los parámetros de salida y los casos especiales para interpretar los identificadores secundarios devueltos por los métodos IAccessible.
ms.assetid: 051ec5ba-540c-4ae1-b917-4c229557ca2f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c03026e6abf769efab95cc513231fad3af64511f
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104420961"
---
# <a name="how-child-ids-are-used-in-parameters"></a><span data-ttu-id="58702-103">Cómo se usan los identificadores secundarios en los parámetros</span><span class="sxs-lookup"><span data-stu-id="58702-103">How Child IDs Are Used in Parameters</span></span>

<span data-ttu-id="58702-104">En este tema se describen los parámetros de entrada, los parámetros de salida y los casos especiales para interpretar los identificadores secundarios devueltos por los métodos [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .</span><span class="sxs-lookup"><span data-stu-id="58702-104">This topic describes input parameters, output parameters, and special cases for interpreting child IDs returned from [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) methods.</span></span>

## <a name="input-parameters"></a><span data-ttu-id="58702-105">Parámetros de entrada</span><span class="sxs-lookup"><span data-stu-id="58702-105">Input Parameters</span></span>

<span data-ttu-id="58702-106">Muchas de las funciones de Microsoft Active Accessibility y la mayoría de las propiedades [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) toman una estructura [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) como parámetro de entrada.</span><span class="sxs-lookup"><span data-stu-id="58702-106">Many of the Microsoft Active Accessibility functions and most of the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) properties take a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) structure as an input parameter.</span></span> <span data-ttu-id="58702-107">Para la mayoría de las propiedades **IAccessible** , este parámetro permite a los desarrolladores de cliente especificar si desean información sobre el propio objeto o sobre uno de los elementos simples del objeto.</span><span class="sxs-lookup"><span data-stu-id="58702-107">For most of the **IAccessible** properties, this parameter allows client developers to specify whether they want information about the object itself or about one of the object's simple elements.</span></span>

<span data-ttu-id="58702-108">Microsoft Active Accessibility proporciona la constante **CHILDID \_ Self** para indicar que se necesita información sobre el propio objeto.</span><span class="sxs-lookup"><span data-stu-id="58702-108">Microsoft Active Accessibility provides the constant **CHILDID\_SELF** to indicate that information is needed about the object itself.</span></span> <span data-ttu-id="58702-109">Para obtener información sobre un elemento simple, los desarrolladores de cliente especifican su identificador secundario en el parámetro [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) .</span><span class="sxs-lookup"><span data-stu-id="58702-109">To obtain information about a simple element, client developers specify its child ID in the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) parameter.</span></span>

<span data-ttu-id="58702-110">Al inicializar un parámetro [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) , asegúrese de especificar **VT \_ I4** en el miembro de **VT** , además de especificar el valor de identificador secundario (o **CHILDID \_ Self**) en el miembro **lVal** .</span><span class="sxs-lookup"><span data-stu-id="58702-110">When initializing a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) parameter, be sure to specify **VT\_I4** in the **vt** member in addition to specifying the child ID value (or **CHILDID\_SELF**) in the **lVal** member.</span></span>

<span data-ttu-id="58702-111">Por ejemplo, para obtener el nombre de un objeto, y no uno de los elementos secundarios del objeto, inicialice la [**variante**](/windows/win32/api/oaidl/ns-oaidl-variant) para el primer parámetro de [**IAccessible:: get \_ accName**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accname) ( **CHILDID \_ Self** en el miembro **lVal** y **VT \_ I4** en el miembro **VT** ) y, a continuación, llame a **IAccessible:: get \_ accName**.</span><span class="sxs-lookup"><span data-stu-id="58702-111">For example, to get the name of an object, and not one of the object's child elements, initialize the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) for the first parameter of [**IAccessible::get\_accName**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accname) ( **CHILDID\_SELF** in the **lVal** member and **VT\_I4** in the **vt** member), and then call **IAccessible::get\_accName**.</span></span>

## <a name="output-parameters"></a><span data-ttu-id="58702-112">Parámetros de salida</span><span class="sxs-lookup"><span data-stu-id="58702-112">Output Parameters</span></span>

<span data-ttu-id="58702-113">Varias funciones y métodos [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) tienen un [](/windows/win32/api/oaidl/ns-oaidl-variant) \* parámetro de salida Variant que contiene un identificador secundario o un puntero de interfaz [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) a un objeto secundario.</span><span class="sxs-lookup"><span data-stu-id="58702-113">Several [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) functions and methods have a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant)\* output parameter that contains a child ID or an [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface pointer to a child object.</span></span> <span data-ttu-id="58702-114">Hay diferentes pasos que un cliente debe realizar en función de si reciben un identificador secundario de **VT \_ I4** (elemento simple) o un puntero de interfaz **IDispatch** con **CHILDID \_ Self** (objeto completo).</span><span class="sxs-lookup"><span data-stu-id="58702-114">There are different steps that a client must take depending on whether they receive a **VT\_I4** child ID (simple element) or an **IDispatch** interface pointer with **CHILDID\_SELF** (full object).</span></span> <span data-ttu-id="58702-115">Al seguir estos pasos, se proporcionará un puntero de interfaz **IAccessible** y un identificador secundario que juntos permiten a los clientes usar los métodos y las propiedades de **IAccessible** .</span><span class="sxs-lookup"><span data-stu-id="58702-115">Following these steps will provide an **IAccessible** interface pointer and child ID that together allow clients to use the **IAccessible** methods and properties.</span></span> <span data-ttu-id="58702-116">Estos pasos se aplican a los métodos [**IAccessible:: accHitTest**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest), [**Get \_ accFocus**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accfocus)y [**Get \_ accSelection**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accselection) .</span><span class="sxs-lookup"><span data-stu-id="58702-116">These steps apply to the [**IAccessible::accHitTest**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest), [**get\_accFocus**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accfocus), and [**get\_accSelection**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accselection) methods.</span></span> <span data-ttu-id="58702-117">También se aplican a las funciones de cliente [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint)y [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) .</span><span class="sxs-lookup"><span data-stu-id="58702-117">They also apply to the [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint), and [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) client functions.</span></span>

<span data-ttu-id="58702-118">En la tabla siguiente se enumeran los posibles resultados devueltos y los pasos de procesamiento posteriores necesarios para que los clientes tengan un puntero de interfaz [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) y un identificador secundario.</span><span class="sxs-lookup"><span data-stu-id="58702-118">The following table lists the possible result returned and the required post-processing steps so that clients will have an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer and child ID.</span></span>



| <span data-ttu-id="58702-119">Resultado devuelto</span><span class="sxs-lookup"><span data-stu-id="58702-119">Result returned</span></span>                                      | <span data-ttu-id="58702-120">Procesamiento posterior para el valor devuelto</span><span class="sxs-lookup"><span data-stu-id="58702-120">Post-processing for the return value</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="58702-121">Puntero de interfaz [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch)</span><span class="sxs-lookup"><span data-stu-id="58702-121">[**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface pointer</span></span> | <span data-ttu-id="58702-122">Es un objeto completo. Llame a [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) para tener acceso al puntero de la interfaz [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .</span><span class="sxs-lookup"><span data-stu-id="58702-122">This is a full object.Call [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to access the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer.</span></span><br/> <span data-ttu-id="58702-123">Use el puntero de la interfaz [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) con **CHILDID \_ Self** para tener acceso a los métodos y propiedades de **IAccessible** .</span><span class="sxs-lookup"><span data-stu-id="58702-123">Use the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer with **CHILDID\_SELF** to access **IAccessible** methods and properties.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="58702-124">\_ID. secundario de VT I4</span><span class="sxs-lookup"><span data-stu-id="58702-124">VT\_I4 child ID</span></span>                                      | <span data-ttu-id="58702-125">Llame a [**IAccessible:: get \_ accChild**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild) con el identificador secundario para ver si tiene un puntero de interfaz [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) . Si obtiene un puntero de interfaz [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) , úselo con **CHILDID \_ Self** para tener acceso a los métodos y propiedades de la interfaz [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .</span><span class="sxs-lookup"><span data-stu-id="58702-125">Call [**IAccessible::get\_accChild**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild) using the child ID to see if you have an [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface pointer.If you get an [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface pointer, use it with **CHILDID\_SELF** to access [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface methods and properties.</span></span><br/> <span data-ttu-id="58702-126">Si se produce un error en la llamada a [**Get \_ accChild**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild) , tiene un elemento simple.</span><span class="sxs-lookup"><span data-stu-id="58702-126">If the call to [**get\_accChild**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild) fails, you have a simple element.</span></span> <span data-ttu-id="58702-127">Use el puntero de la interfaz [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) original (el que usó en la llamada al método o la función mencionada anteriormente) con el identificador secundario **VT \_ I4** que devolvió la llamada.</span><span class="sxs-lookup"><span data-stu-id="58702-127">Use the original [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer (the one you used in your call to the method or function mentioned above) with the **VT\_I4** child ID that the call returned.</span></span><br/> |



 

<span data-ttu-id="58702-128">Antes de poder usar un parámetro [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) , debe inicializarlo mediante una llamada a la función [**VariantInit**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantinit) del modelo de objetos componentes (com).</span><span class="sxs-lookup"><span data-stu-id="58702-128">Before you can use a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) parameter, you must initialize it by calling the [**VariantInit**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantinit) Component Object Model (COM) function.</span></span> <span data-ttu-id="58702-129">Cuando termine con la estructura, llame a [**VariantClear**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantclear) para liberar la memoria reservada para esa **variante**.</span><span class="sxs-lookup"><span data-stu-id="58702-129">When finished with the structure, call [**VariantClear**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantclear) to free the memory reserved for that **VARIANT**.</span></span>

## <a name="special-cases"></a><span data-ttu-id="58702-130">Casos especiales</span><span class="sxs-lookup"><span data-stu-id="58702-130">Special Cases</span></span>

<span data-ttu-id="58702-131">Existen excepciones a las instrucciones de la tabla anterior, como cuando el método [**IAccessible:: accHitTest**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest) devuelve un identificador secundario.</span><span class="sxs-lookup"><span data-stu-id="58702-131">There are exceptions to the guidelines in the above table, such as when a child ID is returned by the [**IAccessible::accHitTest**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest) method.</span></span> <span data-ttu-id="58702-132">Los servidores deben devolver una interfaz [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) si el elemento secundario es un objeto accesible.</span><span class="sxs-lookup"><span data-stu-id="58702-132">Servers must return an [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface if the child is an accessible object.</span></span> <span data-ttu-id="58702-133">Si **IAccessible:: accHitTest** devuelve un identificador secundario, el elemento secundario es un elemento simple.</span><span class="sxs-lookup"><span data-stu-id="58702-133">If a child ID is returned by **IAccessible::accHitTest**, the child is a simple element.</span></span>

<span data-ttu-id="58702-134">Además, hay casos especiales para [**accNavigate**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate).</span><span class="sxs-lookup"><span data-stu-id="58702-134">In addition, there are special cases for [**accNavigate**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate).</span></span> <span data-ttu-id="58702-135">Para obtener más información, vea **IAccessible:: accNavigate** y [navegación espacial y lógica](spatial-and-logical-navigation.md).</span><span class="sxs-lookup"><span data-stu-id="58702-135">For more information, see **IAccessible::accNavigate** and [Spatial and Logical Navigation](spatial-and-logical-navigation.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="58702-136">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="58702-136">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="58702-137">**Vista**</span><span class="sxs-lookup"><span data-stu-id="58702-137">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="58702-138">Interfaz IDispatch</span><span class="sxs-lookup"><span data-stu-id="58702-138">IDispatch Interface</span></span>](idispatch-interface.md)
</dt> <dt>

[<span data-ttu-id="58702-139">VARIANT (estructura)</span><span class="sxs-lookup"><span data-stu-id="58702-139">VARIANT Structure</span></span>](variant-structure.md)
</dt> </dl>

 

