---
description: Un paquete de doble propósito es un paquete de Windows Installer 5.0 que se ha escrito para poder instalar una aplicación en el contexto de instalación por usuario o por equipo.
ms.assetid: b2da9fba-8fdf-48fa-a662-6b3eee1bfe87
title: Creación de paquetes únicos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4c89a24c692591326d0498ce6da028ca3fa7eccd9b66db642105fad35a0aaccc
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/11/2021
ms.locfileid: "119628215"
---
# <a name="single-package-authoring"></a>Creación de paquetes únicos

Un paquete de doble propósito es un paquete de Windows Installer 5.0 que se ha escrito para poder instalar una aplicación en el contexto de instalación por usuario o por [equipo.](installation-context.md) Los desarrolladores de instalación que usan un paquete de doble propósito para su aplicación pueden proporcionar a sus usuarios una opción de contexto de instalación en el momento de la instalación y pueden quitar los mensajes de credenciales de UAC de las instalaciones por usuario en Windows 7 o Windows Server 2008 R2. El desarrollo de un paquete de Windows Installer 5.0 de doble propósito para la instalación en Windows 7 y Windows Server 2008 R2 se conoce como creación de paquetes únicos.

Puede empezar a desarrollar paquetes de doble propósito para Windows 7 y Windows Server 2008 R2 mediante Windows Installer 5.0, la propiedad [**MSIINSTALLPERUSER,**](msiinstallperuser.md) la propiedad [**ALLUSERS**](allusers.md) y las carpetas y registros conocidos compatibles con el usuario de [Windows Shell.](/previous-versions/windows/desktop/legacy/bb773177(v=vs.85)) Cuando Windows Installer 5.0 instala un paquete de doble propósito en el contexto por usuario en Windows 7 o Windows Server 2008 R2, el instalador dirige las entradas de archivo y registro a ubicaciones por usuario y no muestra las solicitudes de credenciales de UAC. Cuando Windows Installer 5.0 instala un paquete de doble propósito en el contexto por equipo, el instalador dirige los archivos y las entradas del Registro a las ubicaciones por máquina y solicita las credenciales de UAC para confirmar que el usuario tiene privilegios suficientes para instalar software para todos los usuarios del equipo. Una Windows Installer 5.0 instala una aplicación, usa el mismo contexto de instalación para todas las actualizaciones, reparaciones o eliminaciones posteriores de la aplicación.

**[Windows Installer 4.5](not-supported-in-windows-installer-4-5.md)** o versiones anteriores: no se admiten las propiedades [**MSIINSTALLPERUSER**](msiinstallperuser.md) y por usuario de carpetas a las que hacen referencia las propiedades [**ProgramFilesFolder**](programfilesfolder.md), [**CommonFilesFolder**](commonfilesfolder.md), [**ProgramFiles64Folder**](programfiles64folder.md)y [**CommonFiles64Folder.**](commonfiles64folder.md) Las **carpetas FOLDERID \_ UserProgramFiles** y **FOLDERID \_ UserProgramFilesCommon** están disponibles a partir de Windows 7 y Windows Server 2008 R2. Esto significa que las instalaciones desarrolladas para Windows Installer 4.5 o versiones anteriores dirigen archivos y entradas del Registro a ARCHIVOS de programa \_ FOLDERID, FOLDERID \_ ProgramFilesCommon, FOLDERID \_ ProgramFilesX64 y FOLDERID \_ ProgramFilesCommonX64. Dado que se trata de ubicaciones accesibles para otros usuarios del equipo, Windows Vista y sistemas posteriores requieren la visualización de solicitudes de credenciales de UAC.

Cuando un usuario instala un paquete de doble propósito que se creó para Windows Installer 5.0 con Windows Installer 4.5 o una versión anterior, el instalador omite la propiedad [**MSIINSTALLPERUSER.**](msiinstallperuser.md) En este caso, la instalación puede dirigir archivos y entradas del Registro a ubicaciones accesibles para otros usuarios y requerir que el sistema muestre las solicitudes de credenciales de UAC. Windows El instalador 5.0 puede instalar un paquete desarrollado para Windows Installer 4.5 o versiones anteriores; sin embargo, la instalación dirige archivos y entradas del Registro a ubicaciones accesibles para otros usuarios y requiere que el sistema muestre las solicitudes de credenciales de UAC.

## <a name="development-guidelines"></a>Directrices de desarrollo

Siga las siguientes directrices de creación de paquetes únicos para asegurarse de que el paquete se puede instalar en el contexto por usuario o por equipo. Siga estas directrices para permitir que el usuario elija en el momento de la instalación una instalación por usuario o por equipo y para quitar los mensajes de UAC de las instalaciones por usuario.

-   La instalación por usuario requiere Windows Installer 5.0 en Windows 7 o Windows Server 2008 R2. Debe informar al usuario de que el paquete admite la instalación por máquina de la aplicación en versiones anteriores del sistema.
-   Inicialice los valores de [**las propiedades ALLUSERS**](allusers.md) y [**MSIINSTALLPERUSER**](msiinstallperuser.md) en la tabla [de propiedades](property-table.md) del paquete de doble propósito. Use **el valor ALLUSERS** de 2 y un valor **MSIINSTALLPERUSER** de 1 como valores iniciales. Esto especifica la instalación por usuario como valor predeterminado para el paquete de doble propósito.
-   Considere la posibilidad de crear un cuadro de diálogo para la [interfaz](user-interface.md) de usuario del paquete de doble propósito que permita al usuario elegir el contexto en el momento de la instalación. Cree los controles en este cuadro de diálogo personalizado para establecer los valores de las propiedades [**ALLUSERS**](allusers.md) [**y MSIINSTALLPERUSER.**](msiinstallperuser.md) Para el valor **ALLUSERS** de 2, establezca **MSIINSTALLPERUSER** en un valor de 1 para especificar una instalación por usuario y establezca **MSIINSTALLPERUSER** en una cadena vacía ("") para especificar una instalación por equipo. Los usuarios también pueden establecer **ALLUSERS** y **MSIINSTALLPERUSER** en la línea de comandos si instalan el paquete desde la línea de comandos.
-   Valide el paquete mediante [evaluadores de coherencia internos: ICEs](internal-consistency-evaluators-ices.md). El paquete debe poder pasar la validación por [ICE105](ice-105.md) para que sea un paquete válido de doble propósito.
-   Use la [tabla del Registro](registry-table.md) y la tabla [RemoveRegistry para](removeregistry-table.md) redirigir las entradas del Registro a las partes por usuario del registro durante las instalaciones por usuario. En una instalación por usuario, las entradas del Registro que tienen -1 en la columna Raíz se redirigen a **HKEY \_ CURRENT \_ USER** y, en una instalación por equipo, se dirigen a **HKEY \_ LOCAL \_ MACHINE**. En una instalación por usuario, las entradas del Registro que tienen msidbRegistryRootClassesRoot (0) en la columna Raíz se redirigen a las clases de software **HKCU** y, en una instalación por equipo, se dirigen a las clases de \\  \\ software **HKLM** \\  \\ .
-   Use la [**propiedad ProgramFilesFolder**](programfilesfolder.md) de la tabla [Directory](directory-table.md) de paquetes del instalador de Windows de [32](32-bit-windows-installer-packages.md) bits para especificar las ubicaciones de directorios que contienen componentes de 32 bits no compartidos entre aplicaciones. Cuando un usuario instala el paquete de doble propósito mediante el contexto por equipo, estos componentes se guardan en la carpeta Archivos de programa en versiones de 32 bits de Windows y en la carpeta Archivos de programa (x86) en versiones de 64 bits del sistema. Todos los usuarios pueden acceder a los componentes de estos directorios. Cuando un usuario instala el paquete de doble propósito en Windows 7 o Windows Server 2008 R2 mediante el contexto por usuario, estos componentes se guardan en la carpeta Programas del usuario actual (por ejemplo, en %LocalAppData% Programs) y solo ese usuario puede acceder a \\ ellos.
-   Use la [**propiedad CommonFilesFolder**](commonfilesfolder.md) de la tabla [Directory](directory-table.md) de paquetes del instalador de Windows de [32](32-bit-windows-installer-packages.md) bits para especificar las ubicaciones de los directorios que contienen componentes de 32 bits compartidos entre aplicaciones. Cuando un usuario instala el paquete de doble propósito mediante el contexto por equipo, estos componentes se guardan en la carpeta Archivos comunes y todos los usuarios pueden acceder a ellos. Cuando un usuario instala el paquete de doble propósito en Windows 7 o Windows Server 2008 R2 mediante el contexto por usuario, estos componentes se guardan en la carpeta Common del usuario actual (por ejemplo, en %LocalAppData% Programs Common) y solo ese usuario puede acceder a estos \\ \\ componentes.
-   Use la [**propiedad ProgramFiles64Folder**](programfiles64folder.md) de la tabla [Directory](directory-table.md) de paquetes del instalador de Windows de [64](64-bit-windows-installer-packages.md) bits para especificar las ubicaciones de los directorios que contienen componentes de 64 bits no compartidos entre aplicaciones. Cuando un usuario instala el paquete de doble propósito mediante el contexto por equipo, estos componentes se guardan en la carpeta Archivos de programa. Todos los usuarios pueden acceder a los componentes de estos directorios. Cuando un usuario instala el paquete de doble propósito en Windows 7 o Windows Server 2008 R2 mediante el contexto por usuario, estos componentes se guardan en la carpeta Programas del usuario actual (por ejemplo, en %LocalAppData% Programs) y solo ese usuario puede acceder a \\ ellos. Para obtener más información sobre cómo crear un paquete para instalar una aplicación en sistemas operativos de 64 bits, vea Windows Installer en sistemas operativos de [64 bits.](windows-installer-on-64-bit-operating-systems.md)
-   Use la [**propiedad CommonFiles64Folder**](commonfiles64folder.md) de la tabla [Directory](directory-table.md) de paquetes del instalador de Windows de [64](64-bit-windows-installer-packages.md) bits para especificar las ubicaciones de los directorios que contienen componentes de 64 bits compartidos entre aplicaciones. Cuando un usuario instala el paquete de doble propósito mediante el contexto por equipo, estos componentes se guardan en la carpeta Archivos comunes y todos los usuarios pueden acceder a ellos. Cuando un usuario instala el paquete de doble propósito en Windows 7 o Windows Server 2008 R2 mediante el contexto por usuario, estos componentes se guardan en la carpeta Common del usuario actual (por ejemplo, en %LocalAppData% Programs Common) y solo ese usuario puede acceder a estos \\ \\ componentes.
-   Use las propiedades [**ProgramFilesFolder**](programfilesfolder.md) y [**CommonFilesFolder**](commonfilesfolder.md) de la tabla [Directory](directory-table.md) de paquetes del instalador de Windows de [64](64-bit-windows-installer-packages.md) bits para especificar la ubicación de los directorios que contienen componentes de 32 bits. Use nombres diferentes para las versiones de 32 y 64 bits de los componentes proporcionados con el mismo nombre o, como alternativa, guarde las versiones en carpetas diferentes. Por ejemplo, agregue información a la tabla Directory para especificar la ubicación del directorio que contiene la versión de 32 bits como ProgramFilesFolder ISV Name Application Name x86 y la ubicación del directorio que contiene la versión de 64 bits como \[ \] \\  \\  \\ \[ Program64FilesFolder \] \\ *ISV Name* \\ *Application Name* \\ x64. Después, una instalación por máquina guarda la versión de 32 bits en Archivos de programa (x86) Nombre de aplicación de ISV x86 y guarda la versión de 64 bits en Archivos de programa Nombre de ISV Nombre de aplicación \\  \\  \\ \\  \\  \\ x64. Una instalación por usuario guarda la versión de 32 bits en %LocalAppData% Programs ISV Name Application Name x86 e instala la versión de 64 bits en \\ \\  \\  \\ %LocalAppData% \\ Programs \\ *ISV Name* \\ *Application Name* \\ x64.
-   Almacene los datos de configuración por usuario de la aplicación en Usuarios nombre \\ \\ *de usuario* \\ AppData.
-   Almacene las plantillas y los archivos generados por la aplicación en subcarpetas en El \\ nombre de usuario de los \\ *usuarios.*
-   Si la aplicación usa extensiones de shell, debe usar los puntos de [extensibilidad](https://msdn.microsoft.com/library/bb762762.aspx) de shell compatibles por usuario que están disponibles a partir de Windows 7 o Windows Server 2008 R2.
-   No use acciones personalizadas en el paquete que requieran privilegios elevados para ejecutarse. La [tabla CustomAction](customaction-table.md) no debe contener acciones personalizadas marcadas para ejecutarse con privilegios elevados. Para obtener más información sobre las acciones personalizadas con privilegios elevados, vea [Custom Action Security](custom-action-security.md).
-   No escriba en ninguna carpeta global del sistema. La [tabla Directory](directory-table.md) no debe contener una referencia a ninguna de las siguientes propiedades de carpeta del sistema.

    <dl>

[**AdminToolsFolder**](admintoolsfolder.md)  
    [**CommonAppDataFolder**](commonappdatafolder.md)  
    [**FontsFolder**](fontsfolder.md)  
    [**System16Folder**](system16folder.md)  
    [**System64Folder**](system64folder.md)  
    [**SystemFolder**](systemfolder.md)  
    [**TempFolder**](tempfolder.md)  
    [**WindowsFolder**](windowsfolder.md)  
    [**WindowsVolume**](windowsvolume.md)  
    </dl>

-   No instale un ensamblado de Common Language Runtime en la caché global de ensamblados (GAC). Para obtener más información sobre cómo instalar ensamblados en la caché global de ensamblados, vea Agregar ensamblados [a](adding-assemblies-to-a-package.md) un paquete e Instalación de ensamblados de [Common Language Runtime.](installation-of-common-language-runtime-assemblies.md)
-   No instale ningún origen de datos ODBC. No use la [tabla ODBCDataSource](odbcdatasource-table.md) para instalar un origen de datos.
-   No instale ningún servicio. No use la [tabla ServiceInstall](serviceinstall-table.md) para instalar un servicio.

## <a name="example"></a>Ejemplo

Se proporciona un ejemplo de un paquete de doble propósito en [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md) (Componentes del SDK de Windows desarrolladores de instaladores de PUASample1.msi). Si tiene el SDK actual, tiene acceso a todas las herramientas y datos necesarios para reproducir el paquete de instalación de ejemplo. Para obtener más información sobre este ejemplo, vea [Ejemplo de creación de paquetes únicos.](single-package-authoring-example.md)

 

 
