---
title: Introducción a la capa XML
description: La API XML de WWSAPI se basa en los objetos Lector XML y Escritor XML, que permiten leer o escribir documentos XML solo de forma adelantada. La capa XML proporciona a la aplicación acceso total y control sobre el contenido de los mensajes.
ms.assetid: 938ca257-fbb8-4569-b791-2148abb1a5a5
keywords:
- Servicios web de información general sobre capas XML para Windows
- WWSAPI
- Wws
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f8572a9b1d56935c6eb1a09455038b5837bca681a4e07d8ebd85bbb61610ce82
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/11/2021
ms.locfileid: "119082979"
---
# <a name="xml-layer-overview"></a>Introducción a la capa XML

La API XML de WWSAPI se basa en los objetos Lector [XML](xml-reader.md) y Escritor [XML,](xml-writer.md) que permiten leer o escribir documentos XML solo de forma adelantada. La capa XML proporciona a la aplicación acceso total y control sobre el contenido de los mensajes.

## <a name="encoding"></a>Encoding

La API XML admite documentos codificados como:

-   Texto (UTF-8, UTF-16LE, UTF-16BE)
-   Binary
-   MTOM

## <a name="storage"></a>Storage

La API XML admite el procesamiento de documentos almacenados como:

-   Búfer en memoria de bytes codificados
-   Una secuencia
-   Un [búfer XML](xml-buffer.md)

Un [búfer XML](xml-buffer.md) es una representación estructurada en memoria de un documento XML. Se trata de una representación más eficaz que un documento codificado como bytes. Un documento XML almacenado en un búfer XML se puede navegar, leer o escribir.

## <a name="io"></a>E/S

La API XML nunca realizará E/S a menos que se solicite específicamente. Además, cualquier E/S se puede iniciar de forma asincrónica. Consulte [**WsFillReader**](/windows/desktop/api/WebServices/nf-webservices-wsfillreader) y [**WsFlushWriter para**](/windows/desktop/api/WebServices/nf-webservices-wsflushwriter) obtener más información sobre el procesamiento asincrónico con la API XML.

## <a name="processing"></a>Processing

La API XML tiene tres niveles distintos en los que se puede procesar el documento.

Un documento se puede procesar en [**un nodo**](/windows/desktop/api/WebServices/ns-webservices-ws_xml_node) a la vez. Esto ofrece el control más específico del contenido XML y proporciona una fidelidad completa de los datos del documento. En este nivel, se usarían [**las funciones WsReadNode**](/windows/desktop/api/WebServices/nf-webservices-wsreadnode) y [**WsWriteNode**](/windows/desktop/api/WebServices/nf-webservices-wswritenode) y [**WsCopyNode.**](/windows/desktop/api/WebServices/nf-webservices-wscopynode)

El siguiente nivel de control son API como [**WsReadStartElement,**](/windows/desktop/api/WebServices/nf-webservices-wsreadstartelement) [**WsReadValue**](/windows/desktop/api/WebServices/nf-webservices-wsreadvalue) y [**WsReadEndElement.**](/windows/desktop/api/WebServices/nf-webservices-wsreadendelement) Estas API proporcionan numerosos tipos de validación, omiten espacios en blanco y comentarios, y normalizan el texto y CDATA para presentar al consumidor una vista más sencilla del xml.

El nivel de control más alto es usar la API de serialización. Estas API están controladas por una asignación entre tipos de datos de C y XML, y pueden leer o escribir una estructura compleja en memoria en xml y de vuelta con una sola función como [**WsWriteElement**](/windows/desktop/api/WebServices/nf-webservices-wswriteelement) y [**WsReadElement.**](/windows/desktop/api/WebServices/nf-webservices-wsreadelement)

Las API de canonización XML se pueden usar para generar una forma canónica de XML que, a su vez, se puede usar para generar firmas criptográficas sobre contenido XML.

## <a name="creating-a-writer"></a>Creación de un escritor

Para crear y usar un escritor para escribir en un búfer en memoria:

``` syntax
WsCreateWriter              // Create an instance of a WS_XML_WRITER
// Initialize a WS_XML_WRITER_BUFFER_OUTPUT
WsSetOutput                 // Set the encoding and output of the writer along with any other writer properties
// Write Elements
WsGetWriterProperty(..., WS_XML_WRITER_PROPERTY_BYTES, ...)  // Get the generated bytes as a single byte array
// Use the generated bytes
WsFreeWriter                // Free the writer
```

Para crear y usar un escritor para escribir en una secuencia:

``` syntax
WsCreateWriter              // Create an instance of a WS_XML_WRITER
// Initialize a WS_XML_WRITER_STREAM_OUTPUT
WsSetOutput                 // Set the encoding and output of the writer along with any other writer properties
// Write Elements
WsFlushWriter               // Force any buffered data to be written
WsFreeWriter                // Free the writer
```

Para crear y usar un sistema de escritura para escribir en un búfer [XML de WS \_ \_ ](ws-xml-buffer.md):

``` syntax
WsCreateXmlBuffer           // Create the buffer to write to
WsCreateWriter              // Create an instance of a WS_XML_WRITER
WsSetOutputToBuffer         // Set the output buffer along with any other writer properties
// Write Elements
WsFreeWriter                // Free the writer
// The buffer has the generated document
```

En todos los casos, se puede incluir la propiedad [**WS \_ XML WRITER PROPERTY \_ \_ \_ INDENT**](/windows/desktop/api/WebServices/ne-webservices-ws_xml_writer_property_id) para dar formato al xml.

## <a name="writing-elements"></a>Escritura de elementos

Para escribir un elemento en un sistema de escritura:

``` syntax
WsWriteStartElement          // Write a start element
for each attribute
{
// Write an attribute using either
WsWriteStartAttribute    // Write a start attribute
// Write Content
WsWriteEndAttribute      // Write an end attribute
// Or one of the following
WsWriteXmlnsAttribute    // Write an explicit xmlns attribute
}
// Write Elements or Content
WsWriteEndElement
```

También se puede usar lo siguiente:

``` syntax
WsWriteArray                 // Write an array of primitive values as a series of repeated elements
```

## <a name="writing-content"></a>Escribir contenido

Para escribir contenido en un elemento o atributo, se puede usar lo siguiente:

``` syntax
WsWriteChars                 // Write unicode characters from memory
WsWriteCharsUtf8             // Write UTF-8 encoded characters from memory
WsWriteBytes                 // Write binary data encoded as base64
WsPushBytes                  // Direct the writer to request that bytes be written
WsPullBytes                  // Direct the writer to read the bytes to be written
WsWriteValue                 // Write primitive values such as ints and BOOLs
WsWriteText                  // Write an WS_XML_TEXT
WsWriteQualifiedName         // Write a qualified name
```

Se puede usar lo siguiente para escribir en un documento, pero no se puede usar cuando se encuentra dentro de un atributo.

``` syntax
WsWriteNode                  // Write a single WS_XML_NODE
WsCopyNode                   // Copy a single node, or an entire WS_XML_ELEMENT_NODE and children from an WS_XML_READER
```

Se puede usar lo siguiente para escribir una sección CDATA en un documento de texto:

``` syntax
WsWriteStartCData            // Start a CDATA section in a text encoding
// Write Content
WsWriteEndCData              // End a CDATA section in text encoding
```

## <a name="miscellaneous"></a>Varios

``` syntax
WsGetPrefixFromNamespace     // Find a prefix bound to a namespace
```

## <a name="creating-a-reader"></a>Creación de un lector

Para crear y usar un lector para leer desde un búfer en memoria:

``` syntax
WsCreateReader              // Create an instance of a WS_XML_READER
// Initialize a WS_XML_READER_BUFFER_INPUT
WsSetInput                  // Set the encoding and input of the reader along with any other reader properties
// Read Elements
WsFreeReader                // Free the reader
```

Para crear y usar un lector para el lector desde una secuencia:

``` syntax
WsCreateReader              // Create an instance of a WS_XML_READER
// Initialize a WS_XML_READER_STREAM_INPUT
WsSetInput                  // Set the encoding and input of the reader along with any other reader properties
WsFillReader                // Populate the reader with data from the underlying stream
// Read Elements
WsFreeReader                // Free the reader
```

Para crear y usar un lector para leer desde un [búfer XML de WS \_ \_ ](ws-xml-buffer.md):

``` syntax
WsCreateXmlBuffer           // Create the buffer to write to
WsCreateReader              // Create an instance of a WS_XML_READER
WsSetInputToBuffer          // Set the input buffer along with any other reader properties
// Read Elements
WsFreeReader                // Free the reader
```

## <a name="reading-elements"></a>Lectura de elementos

Para leer un elemento de un lector:

``` syntax
WsReadToStartElement         // Skip whitespace and comments to position the reader on a specific element
for each attribute of interest
{
WsFindAttribute          // Try Locate the attribute
if (found)
{
WsReadStartAttribute // Set the reader to read the attribute
// Read Content
WsReadEndAttribute   // Return the reader to the element
}
}
WsReadStartElement           // Advance the reader past the current element
// Read Elements or Content
WsWriteEndElement            // Advance the reader past the corresponding end element
```

También se puede usar lo siguiente:

``` syntax
WsReadArray                  // Read an array of primitive values as a series of repeated elements
```

## <a name="reading-content"></a>Lectura de contenido

Para leer contenido de un elemento o atributo, se puede usar lo siguiente:

``` syntax
WsReadChars                 // Read characters to memory as unicode
WsReadCharsUtf8             // Read characters to memory encoded as UTF-8
WsReadBytes                 // Read binary data encoded as base64
WsReadValue                 // Read primitive values such as ints and BOOLs
WsReadQualifiedName         // Read a qualified name
```

Se puede usar lo siguiente para inspeccionar el nodo actual en el que se encuentra el lector:

``` syntax
WsGetReaderNode             // Get the current node
```

## <a name="using-a-buffer"></a>Uso de un búfer

Al escribir en un [búfer \_ XML \_ de WS,](ws-xml-buffer.md) se puede usar lo siguiente:

``` syntax
WsGetWriterPosition          // Get the current position of the writer in the document
WsSetWriterPosition          // Set the current position of the writer in the document
WsMoveWriter                 // Move relative to the current position in the document
WsRemoveNode                 // Delete an element or text from a document
```

Al leer desde un [búfer \_ XML \_ de WS,](ws-xml-buffer.md) se puede usar lo siguiente:

``` syntax
WsGetReaderPosition          // Get the current position of the reader in the document
WsSetReaderPosition          // Set the current position of the reader in the document
WsMoveReader                 // Move relative to the current position in the document
```

Se puede usar lo siguiente para modificar un búfer [XML de WS \_ \_ ](ws-xml-buffer.md):

``` syntax

WsRemoveNode                 // Delete an element or text from a document
```

## <a name="other"></a>Otros

``` syntax
WsGetNamespaceFromPrefix     // Find a namespace bound to a prefix
WsGetXmlAttribute            // Find an "xml:space" or "xml:lang" attribute in scope
```

 

 




