### YamlMime:FAQ
metadata:
  title: Cómo crear una barra de herramientas de Explorer-Style Internet
  description: Una de las características clave de la interfaz de usuario de Windows Internet Explorer es la barra de herramientas. No solo proporciona a los usuarios acceso a una amplia gama de características, sino que también permite a los usuarios personalizar su diseño según sus preferencias personales.
  ms.assetid: d24969ec-4dea-44c6-b045-5611de8f1cce
  ms.topic: article
  ms.date: 05/31/2018
  ms.openlocfilehash: 2aea1b1a042ab90335e6be2f2e38b6ef9088a1f0
  ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
  ms.translationtype: MT
  ms.contentlocale: es-ES
  ms.lasthandoff: 09/13/2021
  ms.locfileid: "127569792"
title: Cómo crear una barra de herramientas de Explorer-Style Internet
summary: >
  Una de las características clave de la interfaz de usuario de Windows Internet Explorer es la barra de herramientas. No solo proporciona a los usuarios acceso a una amplia gama de características, sino que también permite a los usuarios personalizar su diseño según sus preferencias personales.


  En la siguiente captura de pantalla se muestra Internet Explorer barra de herramientas y se resaltan algunas de las características clave.


  ![captura de pantalla de la barra de herramientas de Windows Internet Explorer, con etiquetas para ocho características](images/howto1a.jpg)


  Esta barra de herramientas consta básicamente de un control rebar con cuatro bandas: tres barras de herramientas y una barra de menús. Dado que se implementa con la API de controles comunes, los desarrolladores pueden crear barras de herramientas con cualquiera o todas sus características. En este tema se de abordan las características esenciales de la Internet Explorer de herramientas y cómo implementarlas en la aplicación.
sections:
- name: Omitido
  questions:
  - question: >
      El control Rebar
    answer: >
      La estructura subyacente de la barra Internet Explorer barra de herramientas se proporciona mediante un [control rebar](rebar-controls.md). Este control proporciona a los usuarios una manera de personalizar la organización de una colección de herramientas. Cada barra de rebar contiene una o varias *bandas,* que suelen ser rectángulos largos y estrechos que contienen una ventana secundaria, normalmente un control de barra de herramientas.


      El control rebar muestra sus bandas en un área rectangular, normalmente en la parte superior de la ventana. Este rectángulo se subdivide en una o varias franjas que son el alto de una banda. Cada banda puede estar en una franja independiente o se pueden colocar varias bandas en la misma banda.


      Un control rebar proporciona a los usuarios dos maneras de organizar sus herramientas:


      -   Cada banda suele tener un *control en* el borde izquierdo. Los controladores se usan cuando dos o más bandas de una sola franja superan el ancho de la ventana. Al arrastrar el control a la izquierda o a la derecha, los usuarios pueden controlar cuánto espacio se asigna a cada banda.

      -   Los usuarios pueden mover las bandas dentro del rectángulo de presentación de la barra de rebar arrastrando y colocando. A continuación, el control rebar cambia la pantalla para adaptarse a la nueva disposición de bandas. Si se quitan todas las bandas de una franja, se reducirá el alto de la barra de rebar, ampliando el área de visualización.


      Una aplicación puede agregar o quitar bandas según sea necesario. Normalmente, las aplicaciones permiten a los usuarios seleccionar las bandas que desean mostrar mediante el menú Ver o un menú contextual.


      Si el ancho combinado de las bandas de una franja supera el ancho de la ventana, el control rebar ajustará sus anchos según sea necesario. Algunas de las herramientas pueden estar cubiertas por la banda adyacente.


      [La versión 5.80](common-control-versions.md) de los controles comunes proporciona una manera de hacer que las herramientas cubiertas por otra banda puedan ser accesibles para el usuario. Si establece la marca USECHEVRON de RBBS en el miembro fStyle de la estructura \_ [**REBARBANDINFO**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa)  de la banda, se mostrará un botón de contenido adicional para las barras de herramientas que se han cubierto.  Cuando un usuario hace clic en el botón de contenido adicional, se muestra un menú que le permite usar las herramientas ocultas. La siguiente captura de pantalla de Microsoft Internet Explorer 6 muestra el menú que se muestra cuando se cubre parte de la barra de herramientas estándar.


      ![captura de pantalla que muestra el menú que se muestra haciendo clic en el botón de contenido adicional](images/howto2.jpg)


      Puesto que cada banda contiene un control, puede proporcionar flexibilidad adicional a través de la API del control. Por ejemplo, puede implementar la personalización de la barra de herramientas para permitir al usuario agregar, mover o eliminar botones en una barra de herramientas.
  - question: >
      Implementar el control Rebar
    answer: >
      La mayoría de las características de la barra Internet Explorer de herramientas se implementan realmente en las bandas individuales. La implementación del propio control rebar es sencilla y se muestra a continuación.


      1.  Cree el control rebar con [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa). Establezca *dwExStyle en* [**WS EX \_ \_ TOOLWINDOW**](/windows/desktop/winmsg/extended-window-styles) y *lpClassName* en [**REBARCLASSNAME.**](common-control-window-classes.md) Internet Explorer los siguientes estilos de ventana:

          -   [**RBS \_ BANDBORDERS**](rebar-control-styles.md)
          -   [**RBS \_ DBLCLKTOGGLE**](rebar-control-styles.md)
          -   [**REGISTERDROP de RBS \_**](rebar-control-styles.md)
          -   [**RBS \_ VARHEIGHT**](rebar-control-styles.md)
          -   [**CCS \_ NODIVIDER**](common-control-styles.md)
          -   [**CCS \_ NOPARENTALIGN**](common-control-styles.md)
          -   [**WS \_ BORDER**](/windows/desktop/winmsg/window-styles)
          -   [**WS \_ CHILD**](/windows/desktop/winmsg/window-styles)
          -   [**WS \_ CLIPCHILDREN**](/windows/desktop/winmsg/window-styles)
          -   [**CLIPS DE \_ WSIBLINGS**](/windows/desktop/winmsg/window-styles)
          -   [**WS \_ VISIBLE**](/windows/desktop/winmsg/window-styles)

          Establezca los demás parámetros según corresponda para la aplicación.

      2.  Cree un control con [**CreateWindowEx o**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) una función de creación de controles especializada, [**como CreateToolbarEx.**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex)

      3.  Inicialice una banda para el control rellenando los miembros de [**REBARBANDINFO**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa). Incluya el estilo USECHEVRON de RBBS \_ con el **miembro fStyle** para habilitar los contenidos de contenido adicional.

      4.  Agregue la banda al control rebar con un [**mensaje \_ INSERTBAND de RB.**](rb-insertband.md)

      5.  Repita los pasos del 2 al 4 para las bandas restantes.

      6.  Implemente controladores para las notificaciones de rebar. En concreto, deberá controlar [RBN \_ CHEVRONPUSHED](rbn-chevronpushed.md) para mostrar un menú desplegable cuando se haga clic en un botón de contenido adicional. Para obtener más información, vea [Control de los contenidos de contenido adicional.](#handling-chevrons)


      Los controladores se incluyen de forma predeterminada. Para omitir el control de una banda, establezca la marca RBBS NO ARENPPER en el miembro fStyle de la estructura \_ [**REBARBANDINFO de**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa) la banda.  Para obtener más información sobre cómo implementar controles rebar, vea [About Rebar Controls](rebar-controls.md).
  - question: >
      Control de contenido adicional
    answer: >
      Cuando un usuario hace clic en un botón de contenido adicional, el control rebar envía a la aplicación una [notificación \_ RBN CHEVRONPUSHED.](rbn-chevronpushed.md) La [**estructura NMREBARCHEVRON**](/windows/win32/api/commctrl/ns-commctrl-nmrebarchevron) que se pasa con la notificación contiene el identificador de la banda y una estructura [**RECT**](/previous-versions//dd162897(v=vs.85)) con el rectángulo ocupado por el botón de contenido adicional. El controlador debe determinar qué botones están ocultos y mostrar los comandos asociados en un menú emergente.


      En el procedimiento siguiente se describe cómo controlar una [notificación \_ RBN CHEVRONPUSHED:](rbn-chevronpushed.md)


      1.  Recupere el rectángulo delimitador actual de la banda seleccionada enviando al control rebar un [**mensaje \_ GETRECT de RB.**](rb-getrect.md)

      2.  Recupere el número total de botones mediante el envío del control de barra de herramientas de la banda a [**un mensaje \_ BUTTONCOUNT de TB.**](tb-buttoncount.md)

      3.  A partir del botón situado más a la izquierda, recupere el rectángulo delimitador del botón enviando al control de barra de herramientas un [**mensaje \_ GETITEMRECT de TB.**](tb-getitemrect.md)

      4.  Pase los rectángulos de banda y botón a la [**función IntersectRect.**](/windows/desktop/api/winuser/nf-winuser-intersectrect) Esta función devolverá una [**estructura RECT**](/previous-versions//dd162897(v=vs.85)) que corresponde a la parte visible del botón.

      5.  Pase el rectángulo del botón y el rectángulo de la parte visible del botón a la [**función EqualRect.**](/windows/desktop/api/winuser/nf-winuser-equalrect)

      6.  Si [**EqualRect devuelve**](/windows/desktop/api/winuser/nf-winuser-equalrect) **TRUE,** todo el botón está visible. Repita los pasos del 3 al 5 para el botón siguiente de la barra de herramientas. Si **EqualRect devuelve** **FALSE,** el botón está al menos parcialmente oculto y todos los botones restantes estarán completamente ocultos. Continúe con el paso siguiente.

      7.  Cree un menú emergente con elementos para cada uno de los botones ocultos.

      8.  Muestre el menú emergente mediante la [**función TrackPopupMenu.**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) Use el rectángulo de contenido adicional que se pasó con la [notificación \_ RBN CHEVRONPUSHED](rbn-chevronpushed.md) para colocar el menú. El menú debe estar inmediatamente debajo del botón de contenido adicional, con los bordes izquierdos alineados.

      9.  Controle los comandos de menú.
  - question: >
      Barras de herramientas
    answer: >
      La mayor parte de la complejidad de la Internet Explorer barra de herramientas se encuentra en la implementación de controles que son las bandas de rebar. Internet Explorer muestra normalmente cuatro bandas:


      -   Barra de menús

      -   Barra de herramientas estándar

      -   Barra de herramientas de vínculos

      -   Barra de herramientas de direcciones


      Todas estas bandas, incluida la barra de menús, realmente mantienen los controles de la barra de herramientas. En esta sección se describe la implementación de las barras de herramientas estándar y de vínculos. La barra de menús es algo más complicada y se describe por separado en [How to Create an Internet Explorer-Style Menu Bar](cc-faq-iemenubar.yml).


      Los procedimientos básicos para implementar controles de barra de herramientas se de abordan en [Acerca de los controles de la barra de herramientas](toolbar-controls-overview.md). Esta sección se centra en algunas de las características más recientes de la barra de herramientas que Internet Explorer para aumentar la facilidad de uso del control.
  - question: >
      Botones desplegables
    answer: >
      Los botones desplegables admiten varios comandos. Cuando el usuario hace clic en un botón desplegable, el botón muestra un menú emergente en lugar de iniciar un comando. El usuario inicia un comando seleccionándose en el menú. En la siguiente captura de pantalla se muestra un botón desplegable y un menú de la barra Internet Explorer barra de herramientas estándar.


      ![captura de pantalla que muestra el menú desplegable de correo](images/howto3.jpg)


      La funcionalidad desplegable se puede agregar a cualquier estilo de botón agregando una marca de estilo al **miembro fStyle** de la estructura [**TBBUTTON del**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) botón. Hay tres estilos de botón desplegable, todos los cuales se usan en Internet Explorer:


      -   Los botones desplegables sin formato tienen [**el estilo \_ DESPLEGABLE BTNS.**](toolbar-control-and-button-styles.md) Parecen botones normales, pero muestran un menú al hacer clic en él en lugar de iniciar un comando.

      -   Los botones de flecha desplegable simples tienen el [**\_ estilo BTNS WHOLEDROPDOWN.**](toolbar-control-and-button-styles.md) Tienen una flecha que se muestra junto a la imagen o el texto del botón. Aparte de la diferencia de apariencia, son idénticos a los botones desplegables sin formato. El botón Correo que se usa como ejemplo en la ilustración anterior es un botón de flecha desplegable.

      -   Los botones de flecha desplegable que agregan el estilo extendido [**TBSTYLE \_ EX \_ DRAWDDARROWS**](toolbar-extended-styles.md) a [**\_ BTNS DROPDOWN**](toolbar-control-and-button-styles.md) tienen una flecha separada del texto o la imagen. Este estilo de botón combina la funcionalidad de los botones desplegable y estándar. Si el usuario hace clic en la flecha, se muestra un menú y el usuario puede elegir entre varios comandos. Si el usuario hace clic en el botón adyacente, inicia un comando predeterminado. En la captura de pantalla siguiente se muestra Internet Explorer **botón** Atrás, que usa una flecha separada.

          ![captura de pantalla que muestra el menú del botón de división hacia atrás](images/howto4.jpg)

      Cuando el usuario hace clic en un botón desplegable con los estilos de flecha simple o sin formato, el control de barra de herramientas envía a la aplicación una [notificación DESPLEGABLE \_ de TBN.](tbn-dropdown.md) Cuando la aplicación recibe este mensaje, es responsable de crear y mostrar el menú y de controlar el comando seleccionado.


      Cuando el usuario hace clic en una flecha separada, el control de barra de herramientas envía a la aplicación una [notificación DESPLEGABLE \_ de TBN.](tbn-dropdown.md) La aplicación debe controlarla de la misma manera que controla los otros dos tipos de botones desplegables. Si el usuario hace clic en el botón principal, la aplicación recibe un mensaje [**WM \_ COMMAND**](/windows/desktop/menurc/wm-command) con el identificador de comando del botón, como si fuera un botón estándar. Normalmente, las aplicaciones responden iniciando el comando superior en el menú desplegable, pero puede responder de cualquier manera adecuada.
  - question: >
      List-Style botones
    answer: >
      Con los botones estándar, si agrega texto, se muestra debajo del mapa de bits. En la captura de pantalla siguiente se muestran Internet Explorer **los botones Buscar** y **Favoritos** con texto de botón estándar.


      ![captura de pantalla que muestra la barra de herramientas de búsqueda y favoritos con botones estándar](images/howto6.jpg)


      Microsoft Internet Explorer 5 y versiones posteriores usan el [**estilo TBSTYLE \_ LIST.**](toolbar-control-and-button-styles.md) El texto se encuentra a la derecha del mapa de bits, lo que reduce el alto del botón y aumenta la región de visualización. En la ilustración siguiente se muestra Internet Explorer 6 **botones** **Buscar** y Favoritos con el **estilo TBSTYLE \_ LIST.**


      ![captura de pantalla que muestra la barra de herramientas de búsqueda y favoritos mediante botones de estilo de lista](images/howto5.jpg)
  - question: >
      Galones
    answer: >
      Cuando el usuario reorganiza las bandas en el control rebar, parte de una barra de herramientas podría estar cubierta. Si la banda se creó con el estilo USECHEVRON de RBBS, el control rebar mostrará un botón de contenido adicional en el borde derecho de la barra \_ de herramientas. El usuario hace clic en el botón de contenido adicional para mostrar un menú con las herramientas ocultas.
  - question: >
      Hot-Tracking
    answer: >
      Cuando se habilita el seguimiento en caliente, un botón se *activa* cuando el cursor está sobre él. Normalmente, el botón de acceso rápido se distingue de los demás botones de la barra de herramientas por una imagen distintiva. De forma predeterminada, aparece un botón de acceso rápido sobre el resto de la barra de herramientas. Cuando un nuevo botón se activa, la aplicación recibe una [notificación \_ HOTITEMCHANGE DE TBN.](tbn-hotitemchange.md) En la ilustración siguiente se muestra Internet Explorer 5 botones **Buscar** y **Favoritos,** con un **botón Buscar** en caliente. Además de tener un aspecto elevado, el mapa de bits gris del botón se ha reemplazado por uno coloreado.


      ![captura de pantalla que muestra los botones de búsqueda y favoritos, con un botón de búsqueda en caliente](images/howto7.jpg)


      Para habilitar el seguimiento en caliente, cree un control de barra de herramientas con el estilo [**TBSTYLE \_ FLAT**](toolbar-control-and-button-styles.md) o [**TBSTYLE \_ LIST.**](toolbar-control-and-button-styles.md) Se conocen como *barras* de herramientas planas porque los botones individuales no se resaltan normalmente de ninguna manera. Los mapas de bits simplemente se muestran unos junto a otros. Tienen un aspecto similar a un botón solo cuando están en caliente. Estos dos estilos también son transparentes, lo que significa que el fondo de los iconos será el color de la ventana de cliente subyacente.


      Para que se muestre un mapa de bits [](image-lists.md) diferente cuando el botón está en caliente, cree una segunda lista de imágenes que contenga imágenes de acceso rápido para todos los botones de la barra de herramientas. El tamaño y el orden de estas imágenes deben ser los mismos que en la lista de imágenes predeterminada. Envíe al control de barra de [**herramientas un mensaje \_ SETHOTIMAGELIST**](tb-sethotimagelist.md) de TB para establecer la lista de imágenes activas.
additionalContent: "\n## <a name=\"related-topics\"></a>Temas relacionados\n   [Cómo crear una barra de menús Explorer-Style Internet](cc-faq-iemenubar.yml)"
